# **BeerMap**

# **Why this project**

**BeerMap은 이동중에도 맛난 브루어리를 쉽게 찾고 싶다는 개인적인 바람에서 시작했습니다.  
사용자는 이 서비스에서 주소나 매장 이름을 검색해서 브루어리 정보를 찾을 수 있습니다.**

# **Live Demo**

**[사이트로 이동](https://beermap.vercel.app/)**

# **Screenshots**

**(추가 예정정)**

# **Skills & Tools**

![제목 없음2](https://github.com/hamelln/beermap-client/assets/39308313/b1765337-ce4a-4404-872c-70b7a1ad2d96)

# **Challenges & Solutions**

**dialog 상호작용: 모바일 기기에서는 사용자가 뒤로 가기 버튼으로 모달 창을 닫는 경우가 많은데 이런 로직은 데스크탑과 사뭇 다릅니다.** 
- 모바일, 웹 모두에 적용시키기 위해 모달을 Link와 연결하여 URI 인식으로 모달을 여닫는 로직으로 변경했습니다.

**자원 효율 개선: dialog는 닫혀 있어도 내부 요소를 렌더링해서 열기 전부터 리소스를 소모합니다. 이는 지도 API의 요청 낭비와 오동작까지 유발했습니다.**  
- 모달이 열릴 때에만 조건부로 렌더링하도록 변경했습니다.

**FCP 개선: 기존에는 상세 페이지 캐러셀의 모든 이미지를 가져오느라 탐색 시간이 3초를 초과했습니다. 이는 사용 경험을 매우 떨어뜨리는 요소입니다.**  
- 캐러셀의 첫 번째 이미지는 브루어리의 외관으로 고정하도록 패턴화하고 배포 서버에 저장했다가 응답하도록 바꿨습니다.
- 이미지들을 WebP로 경량화하고 Cloudinary를 통해 더 최적화한 이미지를 가져오도록 변경했습니다.
- 바로 보이지 않을 이미지는 lazy loading을 적용했습니다.
- SSR 방식에서 ISR 방식으로 변경했습니다. 현재는 회원 가입, 리뷰 작성 등의 기능을 지원하지 않기 때문에 SSR로 구현할 필요가 없다고 판단했습니다.
- 이를 통해 FCP를 3초 대에서 1초 대로 단축했습니다.

**선 개발, 후 테스트: 테스트하기 더 좋은 때는 있어도 늦은 때는 없습니다. BeerMap은 개발부터 해보자는 매우 가벼운 마음으로 시작했지만 2개월 차에 접어들자 테스트가 필요하다고 판단했습니다.**
- Jest: 컴포넌트 구조가 의존성이 많은지, 경계에 대한 처리를 했는지(검색어 길이를 무한대로 허용하는지, 검색어가 없을 때 어떻게 할지 등) 파악하고 대처할 수 있었습니다.
- Storybook: 컴포넌트의 UI를 독립적으로 보고 의도한 바와 다르게 렌더링되는지 금방 확인할 수 있었습니다.
- Cypress: 서비스를 켜고 직접 모든 기능을 사용하고 검사하는 과정을 자동화했습니다.
- MSW: Storybook과 Jest 동시에 mocking을 지원할 뿐더러, fetch API mocking, Stub 준비에 들어가는 비용을 좀 더 절감할 수 있었습니다.

**크로스 브라우징에 대해 대처하기 좋은 ResponsivelyApp 사용: 여러 환경에서 동시에 실행해 문제를 빠르게 탐색합니다. 이를 통해 일부 구형 iPhone에서 리소스 로딩이 안 되는 문제를 일찍 발견하고 수정했습니다.** 

**CI: GitHub Actions로 CI를 적용하고 테스트 자동화를 통해 좀 더 안정적인 유지보수를 합니다.**

# **학습 / 인사이트**

**트레이드 오프 : 개발 과정에서 비용과 이점을 비교할 때가 많았습니다.** 
- 지도 API 변경: 구글맵 API는 사용이 편하지만 무료 사용량이 적고, 네이버 지도 API는 사용이 불편하지만 무료 사용량이 매우 많습니다. 처음에는 구글맵 API를 사용했지만, 현재는 네이버 지도 API로 변경했습니다. 길찾기 기능도 네이버를 사용하기 때문에 일관성을 유지하기 좋다고 판단했습니다.
- 테스트 도입: 테스트를 도입하지 않아도 기능은 정상적으로 작동했습니다. 테스트가 익숙하지 않아 테스트 환경 설정에도 시간이 걸렸습니다. 사용해본 적 없는 Storybook과 Cypress를 도입하는 것도 고민이 들었지만, 각 테스트는 그만한 학습 비용을 낼 가치가 충분하다고 느꼈고, 테스트를 안 할 때에는 놓쳤던 구조적 문제(의존성, 경계) 등을 금방 찾을 수 있었을 뿐더러 코드에 대한 자신감도 높아졌습니다.

**타입스크립트 학습: 처음에는 프로젝트에 간단한 타이핑만 하되 타입 에러를 구글링해서 해결했습니다. 이런 임시 방편으론 타입스크립트를 쓰는 의미가 희미하다고 판단했고 스터디에 참여하면서 코드를 리팩토링하고 있습니다.**

**사용자 피드백 : 주기적으로 주변 사람들의 정기적인 피드백을 부탁했고, 만드는 데에 수고가 들었던 바텀 시트를 모달로 교체하는 등 중요한 UX 결정을 내릴 수 있었습니다.**

**코드 품질 : 매일 청소하듯이 작은 리팩토링을 하며 가독성이 좋은 코드, 커밋, 작문을 학습중입니다.**

**관점의 확장 : 백엔드 개발과 디자인을 겸했고, 서버 측 HTTP 통신에 대한 이해, 웹 표준에 따른 UI/UX 학습 등을 통해 프론트엔드에만 국한됐던 관점이 좀 더 넓어졌습니다.**

**테스트 고찰 : '무엇을', '언제', '어떻게' 테스트할 것인가에 대한 고민을 했습니다. '사용자의 동작에 초점'을 맞춰서 빨리 하되, 적합한 테스팅 도구를 사용하는 게 좋다고 느꼈습니다.**

# **Code Conventions**

- Magic number 금지. 의미있는 변수로 사용.
- boolean형 식별자는 is, has, are 등의 접두사를 붙일 것.
- 식별자 이름은 길더라도 구체적이고 의미가 명료할 것
- 함수는 작게(하나의 함수가 여러 동작을 실행 X)
- HTTP 요청으로 데이터를 가져오는 함수는 fetch~로 작. 가져오는 로직이 다른 함수들은 get~, add~ 등으로 분류.
- typing은 자동 추론이 미흡할 경우에 작성
- type, interface 이름은 간결하게(예: Brewery)
- 컴포넌트 이름은 자세하게(예: BreweryDetails)

# **Update History**

### **2023/10**

### New

**[10/4] CI 추가(Jest, Chromatic)  
[10/4] UI, E2E 테스트 추가(Storybook, Cypress)  
[10/3] 통합 테스트 추가(Jest)**

### Fixes

**[10/3] 검색 페이지 검색어 길이 30으로 제한.  
[10/3] 서비스 상세 페이지 접속 에러 해결: 배포 서버의 MSW 실행 차단.**

### Changes
**[10/4] 검색 페이지 가로 너비 치우침 수정**

### **2023/9**

### New

**[10/4] CI 추가(Jest, Chromatic)  
[10/4] UI, E2E 테스트 추가(Storybook, Cypress)  
[10/3] 통합 테스트 추가(Jest)**

### Fixes

**[9/8] 모달창을 뒤로 가기 외의 방법으로 닫은 뒤엔 뒤로 가기 기능이 안 먹히는 현상 수정: 어떤 방법으로 닫아도 히스토리를 back하도록 변경.  
[9/7] 상세 페이지 진입이 안 되는 에러 수정: 로딩 컴포넌트의 이미지 경로가 잘못됨에 따라 잘못된 params.id로서 이중으로 전달됐었음.  
[9/6] 캐러셀의 실제 사진 갯수와 표시되는 숫자가 불일치하는 현상 수정.**

### Improvements

**[9/7] 줄바꿈 로직을 지우고 white-space:pre-line으로 수정.**

### Changes

**[9/22] 파비콘 추가.  
[9/22] 로딩 화면 이미지 비율과 상세 페이지 이미지 비율 동기화.  
[9/10] 로고 스타일, 캐러셀 이미지 비율, 설명글 행간 조절.  
[9/8] 설명글 색상 명도 낮춤.**

### **2023/8**

### New

**[8/24] 브루어리 상세 이미지 추가: Clouninary에 요청.  
[8/17] 지도에 줌인, 줌아웃 버튼 추가.  
[8/16] 구글맵 -> 네이버 지도로 변경.  
[8/16] 지도 창에서 주소 복사, 길찾기 기능 추가.  
[8/16] 검색 페이지 용 브루어리 간단 소개 추가.  
[8/4] stub 대신 서버에서 진짜 데이터 가져오도록 변경.  
[8/2] 구글맵 추가.  
[8/2] 바텀 시트추가: 위로 스크롤해서 올리면 구글맵 표시.  
[8/2] 오늘자에 맞춘 영업 시간 보이는 기능 추가.  
[8/2] 주소 클릭 시 주소 복사하는 기능 추가.**

### Fixes

**[8/18] 줌 버튼 오작동 현상 수정: 자체적으로 만든 줌 버튼의 연동성 부족으로 API에 내장된 줌 버튼으로 변경.  
[8/18] 상세 페이지에서 검색 페이지로 돌아올 시 이전 화면 복구 제대로 안 되는 현상 수정: 세션 스토리지 값을 바로 없애지 않고 유지하는 것으로 변경.  
[8/16] 바텀시트 삭제, 주소 클릭 시 지도 표시하는 동작으로 변경: 바텀 시트의 사용성이 안 좋았음.  
[8/9] 검색어 없으면 모든 브루어리를 표시하는 기능 추가.  
[8/8] 로딩 페이지 간소화: 로딩 시간이 애매해서 스피너가 오히려 UX 저해.  
[8/8] 모달 제대로 안 열리는 현상 수정: state로 모달 여닫는 대신 내장된 기능 이용.  
[8/7] 테마 모드 호출 코드 오류 수: useEffect 내부에서 로컬 스토리지 호출하도록 변경.  
[8/2] 콘솔 에러 수정: 세션 스토리지에 값이 있을 때에만 참조하도록 변경.  
[8/2] 주소 연속 클릭 시 애니메이션 중첩 현상 수정: useDebounce 적용.**

### Improvements

**[8/31] 렌더링 효율 개선: 모달 요소를 클릭할 때에만 모달 내부 컴포넌트 렌더링하도록 변경.  
[8/31] useModal 개선: 지도, 영업 시간에서 공통으로 사용할 수 있도록 범용적으로 변경. state로 여닫는 방식 -> URI 인식으로 여닫는 방식.  
[8/24] Cloudinary에서 최적화한 이미지 가져오도록 변경.  
[8/9] 상세페이지와 모달 로직 분리.  
[8/8] 상세 페이지 렌더링 효율 개선: 이미지 경량화(WebP), 후순위 이미지들은 lazy loading.**

### Changes
**[8/31] 영업 시간 닫기 버튼 스타일 수정, 정보칸 글자들 행간 수정, 이미지 화질 수정.  
[8/24] 이미지를 모바일 디바이스 width별에 맞춰서 small, medium, large로 요청하도록 변경.  
[8/17] 내 위치 찾기 클릭 시 초점이 안 맞는 현상 수정: 화면에 맞춰서 css 수정.  
[8/16] 글자들 자동 줄바꿈으로 적용.  
[8/12] axios -> fetch, SSR -> ISR로 변경.  
[8/9] 메인 페이지를 검색 페이지로 변경: 기존의 메인 페이지가 아무 역할이 없었음.  
[8/9] 상세 페이지의 요소 간 간격 수정.  
[8/2] 리스트 아이템 별 구분선 추가.  
[8/2] 캐러셀 좌우 버튼 삭제.  
[8/2] 상세 영업 시간은 클릭할 때에만 추가로 보이도 변경.  
[8/2] 캐러셀 좌상단 화살표가 잘 보이도록 그 부분의 배경 살짝 어둡게 조정.  
[8/2] 아이콘 추가.**

### **2023/7**

### New

**[7/28] 상세 페이지, 캐러셀, 아이콘 추가 및 디자인 수정.  
[7/28] 검색 페이지 -> 상세 페이지 -> 검색 페이지로 복귀 시 이전 결과 캐시하는 기능 추가.**  

### Changes
**[7/28] 검색 페이지, 검색 결과 스타일 수정.  
[7/28] normalize.css 적용.**
